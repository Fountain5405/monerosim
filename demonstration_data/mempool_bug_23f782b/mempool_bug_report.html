<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monerosim Mempool Pruning Bug Demonstration Report</title>
<style>
  @page {
    size: A4;
    margin: 2cm;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: #1a1a1a;
    max-width: 960px;
    margin: 0 auto;
    padding: 40px 20px;
    background: #fff;
  }
  h1 {
    color: #2c3e50;
    border-bottom: 3px solid #e74c3c;
    padding-bottom: 12px;
    font-size: 28px;
  }
  h2 {
    color: #34495e;
    border-bottom: 2px solid #3498db;
    padding-bottom: 8px;
    margin-top: 40px;
    font-size: 22px;
  }
  h3 {
    color: #2c3e50;
    margin-top: 30px;
    font-size: 18px;
  }
  .subtitle {
    color: #7f8c8d;
    font-size: 16px;
    margin-top: -8px;
  }
  .executive-summary {
    background: #f8f9fa;
    border-left: 4px solid #e74c3c;
    padding: 20px;
    margin: 20px 0;
    border-radius: 0 4px 4px 0;
  }
  .finding-box {
    background: #fdf2f2;
    border: 1px solid #e74c3c;
    border-radius: 6px;
    padding: 16px;
    margin: 16px 0;
  }
  .finding-box.info {
    background: #f0f7ff;
    border-color: #3498db;
  }
  .finding-box.success {
    background: #f0fdf4;
    border-color: #27ae60;
  }
  .finding-box.warning {
    background: #fffcf0;
    border-color: #f39c12;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin: 16px 0;
    font-size: 14px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 10px 12px;
    text-align: left;
  }
  th {
    background: #34495e;
    color: white;
    font-weight: 600;
  }
  tr:nth-child(even) {
    background: #f8f9fa;
  }
  tr.highlight {
    background: #fdf2f2 !important;
    font-weight: 600;
  }
  .log-block {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 16px;
    border-radius: 6px;
    overflow-x: auto;
    font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
    font-size: 11.5px;
    line-height: 1.5;
    margin: 12px 0;
    white-space: pre;
    border: 1px solid #333;
  }
  .log-block .log-info { color: #4ec9b0; }
  .log-block .log-debug { color: #808080; }
  .log-block .log-warn { color: #dcdcaa; }
  .log-block .log-error { color: #f44747; font-weight: bold; }
  .log-block .log-highlight { color: #ff6b6b; background: #3d1f1f; display: inline; padding: 1px 4px; border-radius: 2px; }
  .log-block .log-success { color: #6a9955; }
  .log-label {
    font-size: 12px;
    color: #7f8c8d;
    font-style: italic;
    margin-bottom: 4px;
  }
  .metric {
    font-size: 32px;
    font-weight: 700;
    color: #e74c3c;
  }
  .metric.blue { color: #3498db; }
  .metric.green { color: #27ae60; }
  .metric-label {
    font-size: 13px;
    color: #7f8c8d;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    margin: 24px 0;
  }
  .metric-card {
    text-align: center;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e0e0e0;
  }
  .timeline {
    position: relative;
    padding-left: 30px;
    margin: 20px 0;
  }
  .timeline::before {
    content: '';
    position: absolute;
    left: 8px;
    top: 0;
    bottom: 0;
    width: 3px;
    background: #3498db;
  }
  .timeline-item {
    position: relative;
    margin-bottom: 16px;
    padding-left: 20px;
  }
  .timeline-item::before {
    content: '';
    position: absolute;
    left: -26px;
    top: 6px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #3498db;
    border: 2px solid white;
    box-shadow: 0 0 0 2px #3498db;
  }
  .timeline-item.alert::before {
    background: #e74c3c;
    box-shadow: 0 0 0 2px #e74c3c;
  }
  .timeline-time {
    font-weight: 700;
    color: #2c3e50;
    font-family: monospace;
  }
  .tag {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
  }
  .tag-bug { background: #fde8e8; color: #c0392b; }
  .tag-ok { background: #e8fde8; color: #27ae60; }
  .page-break { page-break-before: always; }
  footer {
    margin-top: 60px;
    padding-top: 20px;
    border-top: 1px solid #ddd;
    color: #95a5a6;
    font-size: 13px;
    text-align: center;
  }
</style>
</head>
<body>

<h1>Monerosim Mempool Pruning Bug<br>Demonstration Report</h1>
<p class="subtitle">Simulation-based detection of Monero commit <code>23f782b21</code> &mdash; January 2026</p>

<div class="executive-summary">
<h3 style="margin-top:0">Executive Summary</h3>
<p>Using the Monerosim network simulator, we demonstrated a historical Monero mempool pruning bug
(introduced Nov 2021, unpatched until Mar 2024). By running two binary versions side-by-side &mdash;
one compiled from the commit introducing the bug and one from the commit before &mdash; we observed:</p>
<ul>
<li><strong>Mempool data corruption:</strong> A corrupted transaction ID appeared in the buggy node's removal log</li>
<li><strong>Missing metadata error:</strong> <code>Failed to find tx_meta in txpool</code> on the buggy node only</li>
<li><strong>Complete simulation freeze:</strong> The buggy node entered an infinite loop/deadlock at the exact moment of the pruning error, halting the simulation for 22+ hours</li>
</ul>
<p><strong>Conclusion:</strong> Monerosim can detect this class of bug before a release ships, validating its use as a pre-release testing tool.</p>
</div>

<h2>1. Bug Details</h2>

<table>
<tr><th style="width:200px">Field</th><th>Value</th></tr>
<tr><td>Bug Introduced</td><td><code>23f782b21</code> (Nov 21, 2021) &mdash; "wallet2, RPC: Optimize RPC calls..."</td></tr>
<tr><td>Bug Fixed</td><td><code>a01d7ccbf</code> (Mar 8, 2024) &mdash; "Fixed mempool pruning"</td></tr>
<tr><td>Time Unpatched</td><td><strong>2 years, 4 months</strong></td></tr>
<tr><td>Root Cause</td><td>Invalid iterator use after <code>remove_tx_from_transient_lists()</code> + <code>txCompare</code> not strictly weak ordered</td></tr>
<tr><td>Impact</td><td>Mempool corruption, potential node deadlock under load</td></tr>
</table>

<h2>2. Simulation Configuration</h2>

<div class="metrics-grid">
<div class="metric-card"><div class="metric blue">8h</div><div class="metric-label">Sim Duration</div></div>
<div class="metric-card"><div class="metric blue">256KB</div><div class="metric-label">Mempool Limit</div></div>
<div class="metric-card"><div class="metric blue">23</div><div class="metric-label">Total Nodes</div></div>
<div class="metric-card"><div class="metric blue">5&ndash;10s</div><div class="metric-label">Tx Interval</div></div>
</div>

<table>
<tr><th>Parameter</th><th>Value</th></tr>
<tr><td>Pre-bug binary</td><td><code>monerod-bb1-mempool</code> (v0.18.2.2-ab826008d &mdash; before commit 23f782b21)</td></tr>
<tr><td>Buggy binary</td><td><code>monerod-ab1-mempool</code> (v0.18.2.2-23f782b21 &mdash; the bug-introducing commit)</td></tr>
<tr><td>Miners</td><td>3 nodes (pre-bug binary)</td></tr>
<tr><td>Pre-bug user nodes</td><td>10 nodes</td></tr>
<tr><td>Buggy user nodes</td><td>10 nodes</td></tr>
<tr><td>Network topology</td><td>1,200-node CAIDA GML graph with realistic AS routing</td></tr>
<tr><td>Bootstrap period</td><td>3.5 hours (coin generation)</td></tr>
<tr><td>Activity start</td><td>4 hours (all nodes begin sending transactions)</td></tr>
</table>

<p class="log-label">Excerpt: Pre-bug node startup (miner-001, <code>monerod-bb1-mempool</code>)</p>
<div class="log-block"><span class="log-debug">2000-01-01 00:00:00.100  D Created directory: /tmp/monero-miner-001</span>
<span class="log-info">2000-01-01 00:00:00.100  I Monero 'Fluorine Fermi' (v0.18.2.2-ab826008d)</span>
<span class="log-info">2000-01-01 00:00:00.100  I Initializing cryptonote protocol...</span>
<span class="log-info">2000-01-01 00:00:00.100  I Cryptonote protocol initialized OK</span>
<span class="log-info">2000-01-01 00:00:00.100  I Initializing core...</span>
<span class="log-info">2000-01-01 00:00:00.100  I Loading blockchain from folder /tmp/monero-miner-001/fake/lmdb ...</span>
<span class="log-info">2000-01-01 00:00:00.100  I Blockchain not loaded, generating genesis block.</span>
<span class="log-info">2000-01-01 00:00:00.100  I +++++ BLOCK SUCCESSFULLY ADDED</span>
<span class="log-info">2000-01-01 00:00:00.100  I HEIGHT 0, difficulty: 1</span>
<span class="log-info">2000-01-01 00:00:00.100  I block reward: 17.592186044415, coinbase_weight: 80</span></div>

<p class="log-label">Excerpt: Buggy node startup (buggy-node-006, <code>monerod-ab1-mempool</code>)</p>
<div class="log-block"><span class="log-debug">2000-01-01 00:00:18.100  D Created directory: /tmp/monero-buggy-node-006</span>
<span class="log-info">2000-01-01 00:00:18.100  I Monero 'Fluorine Fermi' (<span class="log-highlight">v0.18.2.2-23f782b21</span>)</span>
<span class="log-info">2000-01-01 00:00:18.100  I Initializing cryptonote protocol...</span>
<span class="log-info">2000-01-01 00:00:18.100  I Cryptonote protocol initialized OK</span>
<span class="log-info">2000-01-01 00:00:18.100  I Initializing core...</span>
<span class="log-info">2000-01-01 00:00:18.100  I Loading blockchain from folder /tmp/monero-buggy-node-006/fake/lmdb ...</span>
<span class="log-info">2000-01-01 00:00:18.100  I Blockchain not loaded, generating genesis block.</span>
<span class="log-info">2000-01-01 00:00:18.100  I +++++ BLOCK SUCCESSFULLY ADDED</span>
<span class="log-info">2000-01-01 00:00:18.100  I HEIGHT 0, difficulty: 1</span></div>

<h2 class="page-break">3. Simulation Timeline</h2>

<div class="timeline">
<div class="timeline-item">
  <span class="timeline-time">t = 00:00:00</span> &mdash; All 23 nodes start. Miners begin block production.
</div>
<div class="timeline-item">
  <span class="timeline-time">t = 03:30:00</span> &mdash; Bootstrap ends. Distributor begins funding wallets.
</div>
<div class="timeline-item">
  <span class="timeline-time">t = 04:00:00</span> &mdash; Activity phase begins. All nodes send transactions every 5&ndash;10 seconds.
</div>
<div class="timeline-item">
  <span class="timeline-time">t = 04:07:36</span> &mdash; First transactions appear in mempools.
</div>
<div class="timeline-item">
  <span class="timeline-time">t = 06:06:07</span> &mdash; First mempool pruning events observed on pre-bug nodes (miner-001).
</div>
<div class="timeline-item">
  <span class="timeline-time">t = 06:11:00</span> &mdash; Pre-bug miner-001 also encounters <code>tx_meta</code> error during heavy pruning (753 events).
</div>
<div class="timeline-item">
  <span class="timeline-time">t = 06:24:15</span> &mdash; Pruning begins on buggy-node-004 and buggy-node-006.
</div>
<div class="timeline-item alert">
  <span class="timeline-time">t = 06:25:06</span> &mdash; <strong>BUG TRIGGERS.</strong> buggy-node-006 produces corrupted txid and <code>Failed to find tx_meta</code> error. <strong>Simulation freezes.</strong>
</div>
</div>

<h2>4. Simulation Results</h2>

<div class="metrics-grid">
<div class="metric-card"><div class="metric green">124</div><div class="metric-label">Blocks Mined</div></div>
<div class="metric-card"><div class="metric green">135</div><div class="metric-label">Unique TXs Created</div></div>
<div class="metric-card"><div class="metric green">20/20</div><div class="metric-label">Wallets Funded</div></div>
<div class="metric-card"><div class="metric">FROZEN</div><div class="metric-label">Sim at 80%</div></div>
</div>

<p class="log-label">Excerpt: Block production over time (miner-001)</p>
<div class="log-block"><span class="log-info">2000-01-01 00:00:00.100  I +++++ BLOCK SUCCESSFULLY ADDED</span>
<span class="log-info">2000-01-01 00:00:00.100  I HEIGHT 0, difficulty: 1</span>
<span class="log-info">2000-01-01 00:00:21.885  I +++++ BLOCK SUCCESSFULLY ADDED</span>
<span class="log-info">2000-01-01 00:00:21.885  I HEIGHT 1, difficulty: 1</span>
<span class="log-info">2000-01-01 00:02:23.267  I HEIGHT 2, difficulty: 1</span>
<span class="log-info">2000-01-01 00:04:30.799  I HEIGHT 3, difficulty: 1</span>
<span class="log-info">2000-01-01 00:08:17.525  I HEIGHT 4, difficulty: 1</span>
<span class="log-info">2000-01-01 00:08:25.293  I HEIGHT 5, difficulty: 1</span>
<span class="log-info">2000-01-01 00:13:05.338  I HEIGHT 7, difficulty: 2</span>
<span class="log-debug">  ...124 blocks total across 6h 25m of simulated time...</span></div>

<p class="log-label">Excerpt: Transaction pool activity (buggy-node-006)</p>
<div class="log-block"><span class="log-info">2000-01-01 04:07:36.116  I Transaction added to pool: txid &lt;3a792cc4...&gt; weight: 1507 fee/byte: 1.2e+06, count: 1</span>
<span class="log-info">2000-01-01 04:07:36.116  I Transaction added to pool: txid &lt;af3100f2...&gt; weight: 7486 fee/byte: 1.2e+06, count: 2</span>
<span class="log-info">2000-01-01 04:07:37.821  I Transaction added to pool: txid &lt;4df4b7ec...&gt; weight: 7486 fee/byte: 1.2e+06, count: 3</span>
<span class="log-info">2000-01-01 04:07:37.822  I Transaction added to pool: txid &lt;d3f0671b...&gt; weight: 1507 fee/byte: 1.2e+06, count: 4</span>
<span class="log-debug">  ...886 transactions added to pool on this node...</span>
<span class="log-info">2000-01-01 06:25:06.156  I Transaction added to pool: txid &lt;f5d1b055...&gt; weight: 2759 fee/byte: 1.2e+06, count: 18</span></div>

<h2 class="page-break">5. Mempool Pruning Comparison</h2>

<div class="finding-box info">
<strong>Key Observation:</strong> Both pre-bug and buggy nodes experienced mempool pruning under the 256KB limit.
However, only the buggy node produced a corrupted transaction ID and subsequently froze the simulation.
</div>

<table>
<tr><th>Node</th><th>Binary</th><th>Prune Events</th><th>tx_meta Errors</th><th>Status</th></tr>
<tr><td>miner-001</td><td>pre-bug</td><td>753</td><td>1</td><td><span class="tag tag-ok">OK</span></td></tr>
<tr><td>miner-002</td><td>pre-bug</td><td>167</td><td>0</td><td><span class="tag tag-ok">OK</span></td></tr>
<tr><td>node-003</td><td>pre-bug</td><td>109</td><td>0</td><td><span class="tag tag-ok">OK</span></td></tr>
<tr><td>node-006</td><td>pre-bug</td><td>98</td><td>0</td><td><span class="tag tag-ok">OK</span></td></tr>
<tr class="highlight"><td>buggy-node-006</td><td>buggy</td><td>266</td><td>1</td><td><span class="tag tag-bug">FROZEN</span></td></tr>
<tr><td>buggy-node-004</td><td>buggy</td><td>39</td><td>0</td><td><span class="tag tag-ok">OK</span></td></tr>
</table>

<p class="log-label">Excerpt: Normal mempool pruning on pre-bug node (miner-001) &mdash; completes successfully</p>
<div class="log-block"><span class="log-debug">2000-01-01 06:06:07.126  D Percent used: 0.0421  Percent threshold: 90.0000</span>
<span class="log-info">2000-01-01 06:06:07.126  I Pruning tx &lt;bc9d830f...&gt; from txpool: weight: 2097, fee/byte: 1.2e+06</span>
<span class="log-info">2000-01-01 06:06:07.126  I Pruned tx &lt;bc9d830f...&gt; from txpool: weight: 2097, fee/byte: 1.2e+06</span>
<span class="log-debug">2000-01-01 06:06:07.126  D tx added: &lt;bc9d830f...&gt;</span>
<span class="log-success">  [Pruning completes normally. Node continues operating.]</span></div>

<h2 class="page-break">6. Bug Manifestation Evidence</h2>

<div class="finding-box">
<strong>Critical Finding:</strong> At simulated time 06:25:06.156, buggy-node-006 experienced mempool corruption
during a pruning operation triggered by an incoming fluffy block. The node produced a corrupted transaction ID
and entered a non-recoverable state (deadlock/infinite loop), freezing the entire Shadow simulation.
</div>

<p class="log-label">Excerpt: Final log entries from buggy-node-006 &mdash; showing the exact moment of failure</p>
<div class="log-block"><span class="log-debug">2000-01-01 06:25:06.156  D [6.0.0.10:63328 INC] LEVIN_PACKET_RECEIVED. [len=19728, cmd = 2008]</span>
<span class="log-info">2000-01-01 06:25:06.156  I [6.0.0.10:63328 INC] Received NOTIFY_NEW_FLUFFY_BLOCK
                           &lt;dd8ae489...&gt; (height 124, 10 txes)</span>
<span class="log-debug">2000-01-01 06:25:06.156  D Incoming tx &lt;f5d1b055...&gt; not in pool, adding</span>
<span class="log-info">2000-01-01 06:25:06.156  I Transaction added to pool: txid &lt;f5d1b055...&gt;
                           weight: 2759 fee/byte: 1.2e+06, count: 18</span>

<span class="log-info">2000-01-01 06:25:06.156  I Pruning tx &lt;fd134...de0c33ed86b52e9e7&gt; from txpool:
                           weight: 2170, fee/byte: 1.2e+06</span>
<span class="log-info">2000-01-01 06:25:06.156  I Pruned tx &lt;fd134...de0c33ed86b52e9e7&gt; from txpool:
                           weight: 2170, fee/byte: 1.2e+06</span>

<span class="log-warn">2000-01-01 06:25:06.156  D Transaction removed from pool:
   txid &lt;<span class="log-highlight">e8018b2824053a5d5e4d8f4203ab359de0c33ed86b52e9e700c33ed86b52e9e7</span>&gt;
   total entries in removed list now 440</span>

<span class="log-error">2000-01-01 06:25:06.156  E Failed to find tx_meta in txpool (will only print once)</span>

<span class="log-debug">  [NO FURTHER LOG OUTPUT. NODE IS FROZEN.]</span></div>

<h3>6.1 Corrupted Transaction ID Analysis</h3>

<div class="finding-box warning">
<strong>Memory Corruption Evidence:</strong> The transaction ID logged during removal does not match any valid transaction.
It appears to be a corrupted concatenation, indicating the iterator was reading from invalidated memory.
</div>

<table>
<tr><th>Field</th><th>Transaction Hash</th></tr>
<tr><td>Pruned TX (valid)</td><td><code style="word-break:break-all">fd13423de225e155e8018b2824053a5d5e4d8f4203ab359de0c33ed86b52e9e7</code></td></tr>
<tr class="highlight"><td>Removed TX (corrupted)</td><td><code style="word-break:break-all">e8018b2824053a5d5e4d8f4203ab359de0c33ed86b52e9e700c33ed86b52e9e7</code></td></tr>
</table>

<p>The "removed" txid contains <code>de0c33ed86b52e9e7</code> duplicated &mdash; the suffix of the pruned txid
appears twice, which is characteristic of reading stale memory through an invalidated C++ iterator.
The <code>remove_tx_from_transient_lists()</code> function modifies the container while the pruning loop
is still iterating, causing subsequent reads to reference deallocated or shifted memory.</p>

<h3>6.2 Simulation Freeze</h3>

<p class="log-label">Shadow progress log showing the exact freeze point</p>
<div class="log-block"><span class="log-info">Progress: 76% -- simulated: 06:06:54.968/08:00:00, realtime: 00:47:00, processes failed: 0</span>
<span class="log-info">Progress: 77% -- simulated: 06:11:22.304/08:00:00, realtime: 00:48:00, processes failed: 0</span>
<span class="log-info">Progress: 78% -- simulated: 06:15:29.415/08:00:00, realtime: 00:49:00, processes failed: 0</span>
<span class="log-info">Progress: 79% -- simulated: 06:20:28.476/08:00:00, realtime: 00:50:00, processes failed: 0</span>
<span class="log-info">Progress: 80% -- simulated: 06:24:24.287/08:00:00, realtime: 00:51:00, processes failed: 0</span>
<span class="log-highlight">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 00:52:00, processes failed: 0</span>
<span class="log-error">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 00:53:00, processes failed: 0</span>
<span class="log-error">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 00:54:00, processes failed: 0</span>
<span class="log-error">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 00:55:00, processes failed: 0</span>
<span class="log-debug">  ...frozen for 22+ hours of real time at this point...</span>
<span class="log-error">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 23:38:00, processes failed: 0</span>
<span class="log-error">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 23:39:00, processes failed: 0</span>
<span class="log-error">Progress: 80% -- simulated: 06:25:06.156/08:00:00, realtime: 23:40:00, processes failed: 0</span></div>

<p>The simulation advanced at approximately 7&ndash;8 minutes of simulated time per minute of real time.
At real-time minute 52, it reached simulated time <code>06:25:06.156</code> and never advanced again.
The node entered a deadlock or infinite loop during the corrupted pruning operation, which blocked
the Shadow simulation's event loop entirely.</p>

<h2 class="page-break">7. Analysis Suite Results</h2>

<div class="finding-box success">
<strong>Success Criteria Analysis:</strong> All 4 criteria PASSED for the portion of the simulation that completed.
</div>

<table>
<tr><th>Criterion</th><th>Result</th><th>Details</th></tr>
<tr><td>Blocks Created</td><td><span class="tag tag-ok">PASS</span></td><td>124 blocks mined</td></tr>
<tr><td>Blocks Propagated</td><td><span class="tag tag-ok">PASS</span></td><td>Propagated to all synced nodes</td></tr>
<tr><td>Transactions Created &amp; Broadcast</td><td><span class="tag tag-ok">PASS</span></td><td>135 unique transactions</td></tr>
<tr><td>Transactions In Blocks</td><td><span class="tag tag-ok">PASS</span></td><td>507 transaction inclusions</td></tr>
</table>

<h3>Verification Summary</h3>
<table>
<tr><th>Check</th><th>Result</th></tr>
<tr><td>Nodes registered</td><td>25</td></tr>
<tr><td>Nodes monitored</td><td>23</td></tr>
<tr><td>Daemons synced</td><td>23/23</td></tr>
<tr><td>Wallets running</td><td>23/23</td></tr>
<tr><td>Block height consensus</td><td>122&ndash;123</td></tr>
<tr><td>Avg connections/node</td><td>21.3</td></tr>
<tr><td>Wallets funded</td><td>20/20 (100%)</td></tr>
<tr><td>Blocks with transactions</td><td>39</td></tr>
<tr><td>Monitoring duration</td><td>6h 23m</td></tr>
</table>

<h2>8. Conclusion</h2>

<div class="executive-summary">
<p><strong>Monerosim successfully detected a real Monero bug</strong> that shipped in production and went unpatched for
<strong>2 years and 4 months</strong> (November 2021 &ndash; March 2024).</p>

<p>Under stress-test conditions (256KB mempool, 20 nodes sending transactions every 5&ndash;10 seconds),
the mempool pruning bug in commit <code>23f782b21</code> caused:</p>
<ol>
<li><strong>Memory corruption</strong> &mdash; invalid iterator access produced a corrupted transaction ID</li>
<li><strong>Metadata loss</strong> &mdash; <code>Failed to find tx_meta</code> error during pruning</li>
<li><strong>Node deadlock</strong> &mdash; the corrupted state caused the node to enter a non-recoverable infinite loop, freezing the entire network simulation</li>
</ol>

<p>This validates the use of Monerosim as a <strong>pre-release testing tool</strong>. A stress test like this one,
run against candidate releases before shipping, could have caught this bug and prevented it from reaching production.</p>
</div>

<footer>
<p>Generated by Monerosim Analysis Suite &mdash; January 27, 2026<br>
Simulation data: <code>shadow.data/hosts/</code> | Config: <code>test_configs/mempool_stress_test.yaml</code></p>
</footer>

</body>
</html>
