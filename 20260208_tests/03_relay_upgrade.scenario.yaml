# Test 3: Relay nodes in an upgrade scenario (daemon phases)
# Verifies: relay nodes get daemon_0/daemon_1 phases correctly,
# relay upgrade stagger continues after miners,
# no wallet/script injected during either phase
general:
  stop_time: 4h
  simulation_seed: 777
  bootstrap_end_time: auto
  enable_dns_server: true
  shadow_log_level: warning
  progress: true
  process_threads: 1
  daemon_defaults:
    log-level: 1
    log-file: /dev/stdout
    db-sync-mode: fastest
    no-zmq: true
    non-interactive: true
    disable-rpc-ban: true
    allow-local-ip: true
  wallet_defaults:
    log-level: 1
    log-file: /dev/stdout

network:
  type: 1_gbit_switch

agents:
  miner-{001..003}:
    daemon_0: monerod
    daemon_0_start: auto
    daemon_0_stop: 7200s
    daemon_0_stop_stagger: 30s
    daemon_1: monerod
    daemon_1_start: auto
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 0s
    start_time_stagger: 1s
    hashrate: [40, 35, 25]
    can_receive_distributions: true

  relay-{001..004}:
    daemon_0: monerod
    daemon_0_start: auto
    daemon_0_stop: 7200s
    daemon_0_stop_stagger: 30s
    daemon_1: monerod
    daemon_1_start: auto
    start_time: 5s
    start_time_stagger: 5s

  user-{001..003}:
    daemon_0: monerod
    daemon_0_start: auto
    daemon_0_stop: 7200s
    daemon_0_stop_stagger: 30s
    daemon_1: monerod
    daemon_1_start: auto
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1200s
    start_time_stagger: 5s
    transaction_interval: 60
    activity_start_time: auto
    can_receive_distributions: true

  miner-distributor:
    script: agents.miner_distributor
    wait_time: auto
    transaction_frequency: 30

  simulation-monitor:
    script: agents.simulation_monitor
    poll_interval: 300
