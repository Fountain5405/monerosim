# Test config for subnet_group feature
# Demonstrates Sybil attack simulation where attacker nodes share subnets
#
# Expected IP allocation:
# - attacker_a group: 10.100.0.10, 10.100.0.11, 10.100.0.12 (same /24)
# - attacker_b group: 10.100.1.10, 10.100.1.11 (same /24)
# - Regular nodes: default geographic distribution

general:
  stop_time: 2h
  simulation_seed: 12345
  bootstrap_end_time: 1h
  enable_dns_server: true
  shadow_log_level: warning
  progress: true
  runahead: 100ms
  process_threads: 2
  daemon_defaults:
    log-level: 1
    log-file: /dev/stdout
    db-sync-mode: fastest
    no-zmq: true
    non-interactive: true
    disable-rpc-ban: true
    allow-local-ip: true
  wallet_defaults:
    log-level: 1
    log-file: /dev/stdout

network:
  path: gml_processing/1200_nodes_caida_with_loops.gml
  peer_mode: Dynamic

agents:
  # Attacker cluster A - 3 spy nodes on the same subnet
  spy-a-001:
    daemon: monerod
    script: agents.regular_user
    start_time: 0s
    subnet_group: attacker_a
    daemon_options:
      out-peers: 50
      in-peers: 50
  spy-a-002:
    daemon: monerod
    script: agents.regular_user
    start_time: 1s
    subnet_group: attacker_a
    daemon_options:
      out-peers: 50
      in-peers: 50
  spy-a-003:
    daemon: monerod
    script: agents.regular_user
    start_time: 2s
    subnet_group: attacker_a
    daemon_options:
      out-peers: 50
      in-peers: 50

  # Attacker cluster B - 2 spy nodes on a different subnet
  spy-b-001:
    daemon: monerod
    script: agents.regular_user
    start_time: 3s
    subnet_group: attacker_b
    daemon_options:
      out-peers: 50
      in-peers: 50
  spy-b-002:
    daemon: monerod
    script: agents.regular_user
    start_time: 4s
    subnet_group: attacker_b
    daemon_options:
      out-peers: 50
      in-peers: 50

  # Legitimate miners - no subnet_group, use default IP allocation
  miner-001:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 0s
    hashrate: 30
    can_receive_distributions: true
  miner-002:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 1s
    hashrate: 30
    can_receive_distributions: true
  miner-003:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 2s
    hashrate: 40
    can_receive_distributions: true

  # Legitimate users - no subnet_group
  user-001:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 5s
    transaction_interval: 120
    activity_start_time: 3600
    can_receive_distributions: true
  user-002:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 10s
    transaction_interval: 120
    activity_start_time: 3600
    can_receive_distributions: true

  miner-distributor:
    script: agents.miner_distributor
    wait_time: 3600
    transaction_frequency: 60

  simulation-monitor:
    script: agents.simulation_monitor
    poll_interval: 120
