# Monerosim scaling test configuration (new format)
# Based on config_32_agents_OPT.yaml, converted to named agents with configurable defaults
# Total agents: 32 (5 miners + 27 users)
# Duration: 4h
#
# Performance analysis for 1k agent scaling on 1TB RAM:
#
# DAEMON DEFAULTS (monerod):
#   log-level: 1          - 0=minimal, 1=error+warn, 2=info (1 is good balance)
#   log-file: /dev/stdout - Shadow captures stdout, enables post-sim analysis
#   db-sync-mode: fastest - IMPORTANT: Skip fsync, ~30% faster block writes
#   no-zmq: true          - MODERATE: Disable ZMQ pub/sub, saves memory per agent
#   non-interactive: true - Required for simulation
#   disable-rpc-ban: true - Required: Prevents agents from banning each other
#   allow-local-ip: true  - Required: Allow 192.168.x.x P2P connections
#
# WALLET DEFAULTS (monero-wallet-rpc):
#   log-level: 1          - Same as daemon
#   log-file: /dev/stdout - Shadow captures stdout
#
# GENERAL SETTINGS:
#   process_threads: 1    - Single-threaded for determinism (increase for speed)
#   parallelism: 0        - Auto-detect CPU cores for Shadow parallelism
#   runahead: 100ms       - Allow 100ms simulation lookahead (faster but less accurate)

general:
  stop_time: 5h
  parallelism: 0
  simulation_seed: 12345
  enable_dns_server: true
  shadow_log_level: warning    # Reduce Shadow's own logging
  bootstrap_end_time: 2h
  progress: true
  process_threads: 1           # 1 for determinism, 2+ for speed
  runahead: 100ms              # Faster simulation with slight timing variance

  # Daemon defaults - applied to all monerod instances
  daemon_defaults:
    log-level: 1               # 0=minimal, 1=error+warn, 2=info, 3=debug, 4=trace
    log-file: /dev/stdout      # Shadow captures stdout for analysis
    db-sync-mode: fastest      # fastest|fast|safe - skip fsync
    no-zmq: true               # Disable ZMQ (not used in simulation)
    non-interactive: true      # No TTY interaction
    disable-rpc-ban: true      # Don't ban RPC clients
    allow-local-ip: true       # Allow private IP P2P

  # Wallet defaults - applied to all monero-wallet-rpc instances
  wallet_defaults:
    log-level: 1
    log-file: /dev/stdout

network:
  path: gml_processing/1200_nodes_caida_with_loops.gml
  peer_mode: Dynamic

agents:
  # === MINERS (5 total, staggered 1s apart) ===
  miner-001:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 0s
    hashrate: 25
    can_receive_distributions: true

  miner-002:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 1s
    hashrate: 25
    can_receive_distributions: true

  miner-003:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 2s
    hashrate: 30
    can_receive_distributions: true

  miner-004:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 3s
    hashrate: 10
    can_receive_distributions: true

  miner-005:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.autonomous_miner
    start_time: 4s
    hashrate: 10
    can_receive_distributions: true

  # === USERS (27 total, staggered 2s apart starting at 30m) ===
  user-001:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 30m
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-002:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1802s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-003:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1804s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-004:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1806s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-005:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1808s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-006:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1810s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-007:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1812s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-008:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1814s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-009:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1816s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-010:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1818s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-011:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1820s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-012:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1822s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-013:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1824s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-014:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1826s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-015:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1828s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-016:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1830s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-017:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1832s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-018:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1834s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-019:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1836s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-020:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1838s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-021:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1840s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-022:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1842s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-023:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1844s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-024:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1846s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-025:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1848s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-026:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1850s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  user-027:
    daemon: monerod
    wallet: monero-wallet-rpc
    script: agents.regular_user
    start_time: 1852s
    transaction_interval: 60
    activity_start_time: 7200
    can_receive_distributions: true

  # === SPECIAL AGENTS ===
  miner-distributor:
    script: agents.miner_distributor
    wait_time: 7200
    initial_fund_amount: '1.0'
    max_transaction_amount: '2.0'
    min_transaction_amount: '0.5'
    transaction_frequency: 30

  simulation-monitor:
    script: agents.simulation_monitor
    poll_interval: 300
    detailed_logging: false
    enable_alerts: true
    status_file: shadow.data/monerosim_monitor.log
